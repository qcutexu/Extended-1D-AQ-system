% input: xx = global points
%        type = type of stenosis geometry (1, 2, 3)
%
% output: R0 = values of radius at points xx
%         partialR0 = derivative values of radius at points xx
%         A0 = R0^2
%
% description: returns stenosis geometry information at points xx

function [R0, partialR0, partial2R0, A0] = Stenosis(xx, type, variables)
    
    L = variables.L;
    
    % if type == 0
    % % case 0
    %     R0 =  0.18 *(xx).^0;
    % 
    %     partialR0 = 0 *(xx).^0;
    % 
    %     partial2R0 = 0 *(xx).^0;
    % 
    % 
    % else
    if type == 1 
    % case 1
        R0 =  0.18 - (0.0406)*exp(-10*(xx - L/2).^4);

        partialR0 = -(203*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^3)/125;

        partial2R0 = (609*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^2)/125 - (1624*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^6)/25;
    
    elseif type == 2 
    % case 2
        R0 = 0.18 - 0.0406.*exp(-50*(xx - 2.5 - 0.95.*exp(-0.5*(xx - 3.4).^2 )).^4);

        partialR0 = -(203*exp(-50*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^4) ...
            .*((19*exp(-(xx - 17/5).^2/2).*(xx - 17/5))/20 + 1)...
            .*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^3)/25;

        partial2R0 = (609*exp(-50*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^4).*((19*exp(-(xx - 17/5).^2/2).*(xx - 17/5))/20 + 1).^2 ...
            .*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^2)/25 - (203*exp(-50*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^4) ...
            .*((19*exp(-(xx - 17/5).^2/2))/20 - (19*exp(-(xx - 17/5).^2/2).*(xx - 17/5).^2)/20).*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^3)/25 ...
            - 1624*exp(-50*((19*exp(-(xx - 17/5).^2/2))/20 - xx + 5/2).^4).*((19*exp(-(xx - 17/5).^2/2).*(xx - 17/5))/20 + 1).^2.*((19*exp(-(xx - 17/5).^2/2))/20 ...
            - xx + 5/2).^6;
    
    elseif type ==3 
    % case 3
        R0 = 0.18 - 0.0406*exp(-50*(xx - 3.4 + 0.95*exp(-0.5*(xx - 2.5).^2)).^4);

        partialR0 = -(203*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4) ...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1) ...
            .*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3)/25;

        partial2R0 = (609*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4) ...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2.*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^2)/25 ...
            - 1624*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4).*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2 ...
        .*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^6 - (203*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4) ...
        .*((19*exp(-(xx - 5/2).^2/2))/20 - (19*exp(-(xx - 5/2).^2/2).*(xx - 5/2).^2)/20).*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3)/25;
    
    elseif type ==4
    % 50%
        R0 =  0.18 - (0.09)*exp(-10*(xx - L/2).^4);

        partialR0 = -(18*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^3)/5;

        partial2R0 = (54*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^2)/5 - 144*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^6;

    elseif type == 5
    % 60
        R0 =  0.18 - (0.072)*exp(-10*(xx - L/2).^4);

        partialR0 = -(72*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^3)/25;

        partial2R0 = (216*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^2)/25 - (576*exp(-10*(L/2 - xx).^4).*(L/2 - xx).^6)/5;

    elseif type == 6
    % 50
        R0 = 0.18 - 0.09*exp(-50*(xx - 3.4 + 0.95*exp(-0.5*(xx - 2.5).^2)).^4);

        partialR0 = -18*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4)...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1)...
            .*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3;

        partial2R0 = 54*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4)...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2.*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^2 ...
            - 3600*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4).*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2 ...
            .*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^6 - 18*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4).*((19*exp(-(xx - 5/2).^2/2))/20 ...
            - (19*exp(-(xx - 5/2).^2/2).*(xx - 5/2).^2)/20).*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3;

    elseif type == 7
    % 60
        R0 = 0.18 - 0.072*exp(-50*(xx - 3.4 + 0.95*exp(-0.5*(xx - 2.5).^2)).^4);

        partialR0 = -(72*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4)...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3)/5;

        partial2R0 = (216*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4)...
            .*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2.*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^2)/5 ...
            - 2880*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4).*((19*exp(-(xx - 5/2).^2/2).*(xx - 5/2))/20 - 1).^2 ...
            .*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^6 - (72*exp(-50*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^4).*((19*exp(-(xx - 5/2).^2/2))/20 ...
            - (19*exp(-(xx - 5/2).^2/2).*(xx - 5/2).^2)/20).*(xx + (19*exp(-(xx - 5/2).^2/2))/20 - 17/5).^3)/5;
     
    elseif type == 8
    % extreme
        R0 = 0.18 - 0.0406 * exp(-1e10 * (xx - 2.4 + 0.95 * exp(-0.5 * (xx - 3).^4)).^36);

        partialR0 = -14616000000*exp(-10000000000*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^36)...
            .*((19*exp(-(xx - 3).^4/2).*(xx - 3).^3)/10 - 1).*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^35;

        partial2R0 = 511560000000*exp(-10000000000*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^36).*...
            ((19*exp(-(xx - 3).^4/2).*(xx - 3).^3)/10 - 1).^2.*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^34 ...
        - 14616000000*exp(-10000000000*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^36).*((57*exp(-(xx - 3).^4/2).*(xx - 3).^2)/10 ...
            - (19*exp(-(xx - 3).^4/2).*(xx - 3).^6)/5).*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^35 - 5261760000000000000000*exp(-10000000000*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^36).*...
            ((19*exp(-(xx - 3).^4/2).*(xx - 3).^3)/10 - 1).^2.*(xx + (19*exp(-(xx - 3).^4/2))/20 - 12/5).^70;
    
        elseif type == 9
    % extreme
        R0 = 0.18 - 0.018*sin(2*pi/0.5*xx);

        partialR0 = -(9*pi*cos(4*pi*xx))/125;

        partial2R0 = (36*pi^2*sin(4*pi*xx))/125;


    
    end
    %partial2R0 denotes \frac{\partial^2 R_0}{\partial z^2} 
    A0 = R0.^2;

    return
